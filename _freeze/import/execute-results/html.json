{
  "hash": "3d35f0a63132d50e1f29f5221422786e",
  "result": {
    "markdown": "---\ntitle: \"Importation des données\"\ntitle-block-banner: true\ndescription: | \n  Explication de la démarche d'importation.\n# à changer\ndate: \"19 December, 2022\"\n# Modifier les détails que vous voulez\nauthor:\n  - name: \"James Roy\"\n    # Votre site web perso ou github\n    url: https://github.com/JJamesRoy\n    # les champs d'affiliation sont optionnels, vous pouvez les\n    # comment out en ajoutant un # devant.\n    affiliation: FAS1002\n    affiliation-url: https://FAS1002.github.io/A22\n    # changer pour votre propre orcid id\n    # https://orcid.org/ pour vous inscrire.\n    orcid: 0000-0002-0941-5961\n\n# TRUE == Générer une citation pour cette page précise. Pour enlever, mettre false.\ncitation: false\n# Inclure les références que vous utilisez dans vos rapports. Je conseille Zotero pour construire\n# ce fichier ou de connecter RStudio directement pour pouvoir citer avec @nom-de-reference.\nbibliography: references.bib\n---\n\n\n## Quelles sont les bases de données utilisées dans ce travail ?\n\nCe travail utilise les données de [Gapminder](https://www.gapminder.org/) et de [Our World in Data](https://ourworldindata.org/) (en particulier [CO₂ and Greenhouse Gas Emissions](https://github.com/owid/co2-data) et [Energy](https://ourworldindata.org/energy)).\n\n## Importation des données\n\nÀ l'aide d'un script qui utilise les *library* fs de @fs, lubridate de @lubri ainsi que googlesheets4 de @gs4 , les données sont importées directement à partir de lien internet.\n\nLes données de Our World in Data sont mises à jour quotidiennement tandis que celles de Gapminder sont mis à jour mensuellement.\n\n## Nettoyage des données\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fs)\nlibrary(tidyverse)\nlibrary(countrycode)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(\"R/helper.R\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Fichier déjà acquis\"\n[1] \"Fichier déjà acquis\"\n```\n:::\n\n```{.r .cell-code}\nbase_path = path(\"data\",\"raw\")\n\nfiles = list.files(base_path)\n\nfiles_name = path(base_path, files)\n\ndf = lapply(files_name, read.csv)\n\ndat_co2 = df[[1]]\ndat_energy = df[[2]]\ndat_life = df[[3]]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_co2 = dat_co2 %>% drop_na(co2) %>% \n    mutate(continent = countrycode(iso_code, 'iso3c', 'continent')) %>%\n    mutate(continent = recode(continent, `Africa` = \"Afrique\", `Americas` = \"Amériques\", `Asia` = \"Asie\", `Oceania` = \"Océanie\"))\n\ndat_co2$year = ymd(dat_co2$year, truncated = 2L)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_energy = dat_energy %>% drop_na(energy_per_capita) %>% \n    mutate(continent = countrycode(iso_code, 'iso3c', 'continent')) %>% \n    mutate(continent = recode(continent, `Africa` = \"Afrique\", `Americas` = \"Amériques\", `Asia` = \"Asie\", `Oceania` = \"Océanie\"))\n\ndat_energy$year = ymd(dat_energy$year, truncated = 2L)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_life = dat_life %>% select(-X) %>% \n    mutate(continent = countrycode(geo, 'iso3c', 'continent')) %>% \n    mutate(continent = recode(continent, `Africa` = \"Afrique\", `Americas` = \"Amériques\", `Asia` = \"Asie\", `Oceania` = \"Océanie\"))\n\ndat_life$time = ymd(dat_life$time, truncated = 2L)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbase_write = path(\"data\",\"cache\")\n\nfiles_remove = list.files(base_write)\n\nfiles_remove = path(base_write, files_remove)\n\nfile.remove(files_remove)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE TRUE TRUE\n```\n:::\n\n```{.r .cell-code}\nmyList <- list(dat_co2 = dat_co2, \n               dat_energy = dat_energy,\n               dat_life = dat_life)\n\nmapply(write.csv, myList, file=paste0(base_write,\"/\",names(myList), '.csv'))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$dat_co2\nNULL\n\n$dat_energy\nNULL\n\n$dat_life\nNULL\n```\n:::\n:::\n\n\n## Téléchargement des données\n\nL'ensemble des données traitées et non-traitées est disponible sur cette [page.](data.qmd)\n\n## Suite\n\nLes analyses et explorations des données se trouvent sur cette [page.](exploration.qmd)\n",
    "supporting": [
      "import_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}